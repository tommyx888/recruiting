<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test SendGrid Email</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin: 20px 0; }
        .form-group { margin: 20px 0; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        .button { background: #28a745; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; margin: 10px 5px; }
        .button:hover { background: #218838; }
        .alert { padding: 15px; border-radius: 6px; margin: 15px 0; }
        .alert-success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .alert-warning { background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; }
        .alert-info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìß Test SendGrid Email</h1>
        <p>Otestujte posielanie emailov cez SendGrid:</p>
        
        <div class="form-group">
            <label>Test Email Adresa:</label>
            <input type="email" id="testEmail" placeholder="tomas.ficek01@iacgroup.com" value="tomas.ficek01@iacgroup.com">
        </div>
        
        <button class="button" onclick="testSendGridEmail()">üìß Send Test Email</button>
        <button class="button" onclick="testNewRequestEmail()">üìã Test New Request Email</button>
        <button class="button" onclick="testApprovalEmail()">‚úÖ Test Approval Email</button>
        <button class="button" onclick="testCandidateEmail()">üë§ Test Candidate Email</button>
        
        <div id="result"></div>
    </div>

    <div class="container">
        <h3>üìã Test Scenarios:</h3>
        <ul>
            <li><strong>Test Email:</strong> Z√°kladn√Ω test SendGrid funkcionality</li>
            <li><strong>New Request:</strong> Email pri vytvoren√≠ novej ≈æiadosti</li>
            <li><strong>Approval:</strong> Email pri schv√°len√≠ ≈æiadosti</li>
            <li><strong>Candidate:</strong> Email pri pridan√≠ kandid√°ta</li>
        </ul>
    </div>

    <script>
        // Supabase konfigur√°cia
        const config = {
            supabase: {
                url: 'https://jlpkwktqylbykvpafmmc.supabase.co',
                anonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpscGt3a3RxeWxieWt2cGFmbW1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjY1OTIxMjYsImV4cCI6MjA0MjE2ODEyNn0.c-UPO_SNxUGtqLEY4YNpciDLJqtO6j4OSKxS-8y9cFI'
            }
        };

        function showResult(message, type = 'info') {
            const resultDiv = document.getElementById('result');
            const alertClass = type === 'success' ? 'alert-success' : 
                              type === 'error' ? 'alert-warning' : 'alert-info';
            resultDiv.innerHTML = `<div class="alert ${alertClass}">${message}</div>`;
        }

        async function testSendGridEmail() {
            const testEmail = document.getElementById('testEmail').value.trim();
            if (!testEmail) {
                showResult('‚ö†Ô∏è Pros√≠m zadajte test email adresu', 'error');
                return;
            }

            showResult('üîÑ Testujem SendGrid email...', 'info');

            try {
                const response = await fetch(`${config.supabase.url}/functions/v1/send-email-sendgrid`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${config.supabase.anonKey}`
                    },
                    body: JSON.stringify({
                        to: testEmail,
                        subject: 'Test SendGrid Email',
                        html: '<h2>Test SendGrid Email</h2><p>Toto je test email cez SendGrid API.</p>',
                        text: 'Test SendGrid Email\n\nToto je test email cez SendGrid API.',
                        from: 'noreply@iacgroup.com'
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult(`
                        ‚úÖ SendGrid test √∫spe≈°n√Ω!<br>
                        üìß To: ${testEmail}<br>
                        üìß Subject: Test SendGrid Email<br>
                        üìß Response: ${JSON.stringify(data, null, 2)}
                    `, 'success');
                } else {
                    showResult(`
                        ‚ùå SendGrid test zlyhal!<br>
                        üìß Error: ${JSON.stringify(data, null, 2)}
                    `, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Chyba: ${error.message}`, 'error');
            }
        }

        async function testNewRequestEmail() {
            const testEmail = document.getElementById('testEmail').value.trim();
            if (!testEmail) {
                showResult('‚ö†Ô∏è Pros√≠m zadajte test email adresu', 'error');
                return;
            }

            showResult('üîÑ Testujem New Request email...', 'info');

            try {
                const response = await fetch(`${config.supabase.url}/functions/v1/send-email-sendgrid`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${config.supabase.anonKey}`
                    },
                    body: JSON.stringify({
                        to: testEmail,
                        subject: 'Nov√° ≈æiados≈• o n√°bor - Test Position',
                        html: `
                            <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                                <h2 style="color: #2e0de6;">Nov√° ≈æiados≈• o n√°bor</h2>
                                <p>Dobr√Ω de≈à,</p>
                                <p>Bola vytvoren√° nov√° ≈æiados≈• o n√°bor, ktor√° vy≈æaduje va≈°e schv√°lenie:</p>
                                
                                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                    <h3 style="margin-top: 0; color: #333;">Detaily poz√≠cie:</h3>
                                    <p><strong>Poz√≠cia:</strong> Test Position</p>
                                    <p><strong>Oddelenie:</strong> Test Department</p>
                                    <p><strong>Typ:</strong> Test Type</p>
                                    <p><strong>Kateg√≥ria:</strong> Test Category</p>
                                    <p><strong>Poƒçet miest:</strong> 1</p>
                                    <p><strong>Popis:</strong> Test Description</p>
                                </div>
                                
                                <p>Pros√≠m, prihl√°ste sa do syst√©mu a schv√°ƒæte alebo zamietnite t√∫to ≈æiados≈•.</p>
                            </div>
                        `,
                        text: `
    Nov√° ≈æiados≈• o n√°bor

    Dobr√Ω de≈à,

    Bola vytvoren√° nov√° ≈æiados≈• o n√°bor, ktor√° vy≈æaduje va≈°e schv√°lenie:

    Detaily poz√≠cie:
    - Poz√≠cia: Test Position
    - Oddelenie: Test Department
    - Typ: Test Type
    - Kateg√≥ria: Test Category
    - Poƒçet miest: 1
    - Popis: Test Description

    Pros√≠m, prihl√°ste sa do syst√©mu a schv√°ƒæte alebo zamietnite t√∫to ≈æiados≈•.
                        `,
                        from: 'noreply@iacgroup.com'
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult(`
                        ‚úÖ New Request email test √∫spe≈°n√Ω!<br>
                        üìß To: ${testEmail}<br>
                        üìß Subject: Nov√° ≈æiados≈• o n√°bor - Test Position<br>
                        üìß Response: ${JSON.stringify(data, null, 2)}
                    `, 'success');
                } else {
                    showResult(`
                        ‚ùå New Request email test zlyhal!<br>
                        üìß Error: ${JSON.stringify(data, null, 2)}
                    `, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Chyba: ${error.message}`, 'error');
            }
        }

        async function testApprovalEmail() {
            const testEmail = document.getElementById('testEmail').value.trim();
            if (!testEmail) {
                showResult('‚ö†Ô∏è Pros√≠m zadajte test email adresu', 'error');
                return;
            }

            showResult('üîÑ Testujem Approval email...', 'info');

            try {
                const response = await fetch(`${config.supabase.url}/functions/v1/send-email-sendgrid`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${config.supabase.anonKey}`
                    },
                    body: JSON.stringify({
                        to: testEmail,
                        subject: '≈Ωiados≈• o n√°bor schv√°len√° - Test Position',
                        html: `
                            <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                                <h2 style="color: #10b981;">≈Ωiados≈• o n√°bor schv√°len√°</h2>
                                <p>Dobr√Ω de≈à,</p>
                                <p>≈Ωiados≈• o n√°bor bola schv√°len√° GM:</p>
                                
                                <div style="background: #f0fdf4; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #10b981;">
                                    <h3 style="margin-top: 0; color: #333;">Detaily poz√≠cie:</h3>
                                    <p><strong>Poz√≠cia:</strong> Test Position</p>
                                    <p><strong>Oddelenie:</strong> Test Department</p>
                                    <p><strong>Typ:</strong> Test Type</p>
                                    <p><strong>Kateg√≥ria:</strong> Test Category</p>
                                    <p><strong>Poƒçet miest:</strong> 1</p>
                                </div>
                                
                                <p>Teraz m√¥≈æete zaƒça≈• s n√°borom kandid√°tov pre t√∫to poz√≠ciu.</p>
                            </div>
                        `,
                        text: `
    ≈Ωiados≈• o n√°bor schv√°len√°

    Dobr√Ω de≈à,

    Va≈°a ≈æiados≈• o n√°bor bola schv√°len√° GM:

    Detaily poz√≠cie:
    - Poz√≠cia: Test Position
    - Oddelenie: Test Department
    - Typ: Test Type
    - Kateg√≥ria: Test Category
    - Poƒçet miest: 1

    Teraz m√¥≈æete zaƒça≈• s n√°borom kandid√°tov pre t√∫to poz√≠ciu.
                        `,
                        from: 'noreply@iacgroup.com'
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult(`
                        ‚úÖ Approval email test √∫spe≈°n√Ω!<br>
                        üìß To: ${testEmail}<br>
                        üìß Subject: ≈Ωiados≈• o n√°bor schv√°len√° - Test Position<br>
                        üìß Response: ${JSON.stringify(data, null, 2)}
                    `, 'success');
                } else {
                    showResult(`
                        ‚ùå Approval email test zlyhal!<br>
                        üìß Error: ${JSON.stringify(data, null, 2)}
                    `, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Chyba: ${error.message}`, 'error');
            }
        }

        async function testCandidateEmail() {
            const testEmail = document.getElementById('testEmail').value.trim();
            if (!testEmail) {
                showResult('‚ö†Ô∏è Pros√≠m zadajte test email adresu', 'error');
                return;
            }

            showResult('üîÑ Testujem Candidate email...', 'info');

            try {
                const response = await fetch(`${config.supabase.url}/functions/v1/send-email-sendgrid`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${config.supabase.anonKey}`
                    },
                    body: JSON.stringify({
                        to: testEmail,
                        subject: 'Nov√Ω kandid√°t pridan√Ω - Test Candidate',
                        html: `
                            <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                                <h2 style="color: #3b82f6;">Nov√Ω kandid√°t pridan√Ω</h2>
                                <p>Dobr√Ω de≈à,</p>
                                <p>Bol pridan√Ω nov√Ω kandid√°t pre poz√≠ciu <strong>Test Position</strong> v oddelen√≠ <strong>Test Department</strong>:</p>
                                
                                <div style="background: #eff6ff; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #3b82f6;">
                                    <h3 style="margin-top: 0; color: #333;">Detaily kandid√°ta:</h3>
                                    <p><strong>Meno:</strong> Test Candidate</p>
                                    <p><strong>Poz√≠cia:</strong> Test Position</p>
                                    <p><strong>Oddelenie:</strong> Test Department</p>
                                    <p><strong>Zdroj:</strong> Test Source</p>
                                    <p><strong>Status:</strong> New</p>
                                    <p><strong>Pozn√°mky:</strong> Test Notes</p>
                                </div>
                                
                                <p>Pros√≠m, prihl√°ste sa do syst√©mu a pokraƒçujte s procesom n√°boru.</p>
                            </div>
                        `,
                        text: `
    Nov√Ω kandid√°t pridan√Ω

    Dobr√Ω de≈à,

    Bol pridan√Ω nov√Ω kandid√°t do v√°≈°ho oddelenia:

    Detaily kandid√°ta:
    - Meno: Test Candidate
    - Poz√≠cia: Test Position
    - Oddelenie: Test Department
    - Zdroj: Test Source
    - Status: New
    - Pozn√°mky: Test Notes

    Pros√≠m, prihl√°ste sa do syst√©mu a pokraƒçujte s procesom n√°boru.
                        `,
                        from: 'noreply@iacgroup.com'
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult(`
                        ‚úÖ Candidate email test √∫spe≈°n√Ω!<br>
                        üìß To: ${testEmail}<br>
                        üìß Subject: Nov√Ω kandid√°t pridan√Ω - Test Candidate<br>
                        üìß Response: ${JSON.stringify(data, null, 2)}
                    `, 'success');
                } else {
                    showResult(`
                        ‚ùå Candidate email test zlyhal!<br>
                        üìß Error: ${JSON.stringify(data, null, 2)}
                    `, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Chyba: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>
